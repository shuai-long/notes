该 FORM 可以获取区间范围内下一个项目号，从 0000-Z999：

```ABAP
CONSTANTS: GC_PROJ_NUM TYPE CHAR26 VALUE 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.

FORM FRM_GET_NEXT_PSPID USING IV_NUMBER CHANGING EV_PSPID TYPE PS_PSPID.

  DATA: LV_START_ID        TYPE PROJ-PSPID,
        LV_END_ID          TYPE PROJ-PSPID,
        LV_OBJECT          TYPE CHAR2 VALUE 'PD', "Project = "PD" WBS = "PR"
        LT_BUFFER_START_ID TYPE PSHLP_WBS_POSID_TT.

  DATA: LV_START_NUMBER TYPE CHAR1,
        LV_END_NUMBER   TYPE CHAR1.

  DATA: LV_FIND_CHAR  TYPE CHAR1,
        LV_FIND_FDPOS TYPE I.

  LV_START_NUMBER = IV_NUMBER.
  LV_FIND_CHAR = IV_NUMBER.
  IF LV_START_NUMBER EQ '0'.
    LV_END_NUMBER = '9'.
  ELSE.
    LV_END_NUMBER = LV_START_NUMBER.
    SEARCH GC_PROJ_NUM FOR LV_FIND_CHAR.
    IF SY-SUBRC = 0.
      LV_FIND_FDPOS = SY-FDPOS + 1.
    ENDIF.
  ENDIF.

  LV_START_ID = |{ GS_ALV_0100-BUKRS }{ GS_ALV_0100-ZXMLX }{ SY-DATUM+2(2) }{ LV_START_NUMBER }000|.
  LV_END_ID   = |{ GS_ALV_0100-BUKRS }{ GS_ALV_0100-ZXMLX }{ SY-DATUM+2(2) }{ LV_END_NUMBER }998|.

  DATA: LV_INDEX TYPE I.

  CALL FUNCTION 'CN_GET_NEXT_NUMBER'
    EXPORTING
      IV_START_ID        = LV_START_ID
      IV_END_ID          = LV_END_ID
      IV_OBJECT          = LV_OBJECT
      IT_BUFFER_START_ID = LT_BUFFER_START_ID
    IMPORTING
      EV_NEXT_NUMBER     = EV_PSPID
    EXCEPTIONS
      ERROR_MESSAGE      = 1.

  IF SY-SUBRC NE 0.
    PERFORM FRM_GET_NEXT_PSPID USING GC_PROJ_NUM+LV_FIND_FDPOS(1) CHANGING EV_PSPID.
  ELSE.
    RETURN.
  ENDIF.

ENDFORM.
```

